(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{177:function(e,t,n){"use strict";var r=n(261);t.a=function(e){var t=e.store;Object(r.a)({paths:["app"]})(t)}},178:function(e,t,n){"use strict";n(23),n(80),n(267),n(41),n(265),n(25),n(245),n(17),n(34);var r=n(16),o=(n(46),n(4)),c=n(8),f=n(9);function h(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,f=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return c=e.done,e},e:function(e){f=!0,o=e},f:function(){try{c||null==n.return||n.return()}finally{if(f)throw o}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var d=function(){function e(t,n,r){Object(c.a)(this,e),this.api=t,this.info={id:r.id,name:r.name},this.members=[],this.username=n,this._channels={}}var t,n,h,l;return Object(f.a)(e,[{key:"addMessage",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.channel,time=new Date(e.timestamp),r=time.getMinutes().toString();r=1===r.length?"0"+r:r;var o=time.getHours(),c=o>=12?"pm":"am";o=(o%=12).toString().length>1?o:"0".concat(o);var f={title:"".concat(e.name," at ").concat(o,":").concat(r," ").concat(c),subtitle:e.message,self:e.sender===this.username,sender:e.sender};return this._channels[n].messages.push(f),t||this._channels[n].unread++,f}},{key:"load",value:(l=Object(o.a)(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._channels[this.info.name]={messages:[],unread:0},t={group:this.info.id,username:this.username},e.next=4,this.api.post("/groups/members",t);case 4:if(!((n=e.sent).status>=400)){e.next=7;break}return e.abrupt("return",n.statusText);case 7:this.members=n.data.members,this.info.admin=n.data.group.admin_id;case 9:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"markAsRead",value:function(){this._channels[this.channel].unread=0}},{key:"listChannels",value:function(){for(var e=[],t=0,n=Object.entries(this._channels);t<n.length;t++){var o=Object(r.a)(n[t],2),title=o[0],c=o[1].unread;e.push({title:title,unread:c})}return e}},{key:"delete",value:(h=Object(o.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.post("/groups/remove",{group:this.info.id,username:this.info.admin});case 2:if(!((t=e.sent).status>=400)){e.next=5;break}return e.abrupt("return",{error:t.statusText});case 5:return e.abrupt("return",{status:200});case 6:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"kick",value:(n=Object(o.a)(regeneratorRuntime.mark((function e(t){var n,r,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="string"==typeof t?{group:this.info.id,username:t}:{payload:t.map((function(e){return{group:o.info.id,username:e}}))},e.next=3,this.api.post("/groups/leave",n);case 3:if(!((r=e.sent).status>=400)){e.next=6;break}return e.abrupt("return",{error:r.statusText});case 6:return e.abrupt("return",r.data);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"invite",value:(t=Object(o.a)(regeneratorRuntime.mark((function e(t){var n,r,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="string"==typeof t?{group:this.info.id,username:t}:{payload:t.map((function(e){return{group:o.info.id,username:e}}))},e.next=3,this.api.post("/groups/join",n);case 3:if(!((r=e.sent).status>=400)){e.next=6;break}return e.abrupt("return",{error:r.statusText});case 6:return e.abrupt("return",r.data);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"messages",get:function(){return this._channels[this.channel].messages}},{key:"channel",get:function(){return this.info.name},set:function(e){}}]),e}(),m=function(){function e(t,n){var r=this;Object(c.a)(this,e),this.username=null,this.groups=[],this.api=t,this._activeGroup=null,this.modelUpdateFn=null,this.connection=n,this.connection.addListener("connect",(function(){r.username=r.connection.username})),this.connection.addListener("group:member_join",(function(e){var t,n=r.getGroupById(e.group_id);n.members.push(e),(null===(t=r.active)||void 0===t?void 0:t.info.id)===n.info.id&&r.connection.emit("viewUpdate",{group:e.group_id})})),this.connection.addListener("group:member_leave",function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(t){var n,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.user_id!==r.username){e.next=4;break}return e.next=3,r.exit(t.group_id,t.user_id,!0);case 3:return e.abrupt("return");case 4:o=r.getGroupById(t.group_id),(c=o.members.findIndex((function(e){var n=e.user_id;return t.user_id===n})))>=0&&o.members.splice(c,1),null===(n=r.modelUpdateFn)||void 0===n||n.call(r);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}var t,n,r,l;return Object(f.a)(e,[{key:"onNewGroupHandler",value:function(e){this.connection.addListener("group:join",e)}},{key:"onModelUpdate",value:function(e){this.modelUpdateFn=e}},{key:"load",value:(l=Object(o.a)(regeneratorRuntime.mark((function e(){var t,n,r,o,c,f,g;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={username:this.username},e.next=3,this.api.post("/user/memberships",t);case 3:if(!((n=e.sent).status>=400)){e.next=6;break}return e.abrupt("return",n.statusText);case 6:r=n.data.memberships,this.groups=[],o=h(r),e.prev=9,o.s();case 11:if((c=o.n()).done){e.next=19;break}return f=c.value.group,g=new d(this.api,this.username,f),e.next=16,g.load();case 16:this.groups.push(g);case 17:e.next=11;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(9),o.e(e.t0);case 24:return e.prev=24,o.f(),e.finish(24);case 27:case"end":return e.stop()}}),e,this,[[9,21,24,27]])}))),function(){return l.apply(this,arguments)})},{key:"exit",value:(r=Object(o.a)(regeneratorRuntime.mark((function e(t,n){var r,o,c,f,h,l=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=l.length>2&&void 0!==l[2]&&l[2],f=this.getGroupById(t)){e.next=4;break}return e.abrupt("return");case 4:if(c){e.next=12;break}if(f.info.admin!==n){e.next=10;break}return e.next=8,f.delete();case 8:e.next=12;break;case 10:return e.next=12,f.kick(n);case 12:f.info.id===(null===(r=this.active)||void 0===r?void 0:r.info.id)&&(this._activeGroup=null),h=this.groups.findIndex((function(e){return e.info.id===t})),this.groups.splice(h,1),null===(o=this.modelUpdateFn)||void 0===o||o.call(this);case 16:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"add",value:(n=Object(o.a)(regeneratorRuntime.mark((function e(t){var g;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.getGroupById(t.id)){e.next=2;break}return e.abrupt("return");case 2:return g=new d(this.api,this.username,t),this.groups.push(g),e.next=6,g.load();case 6:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"create",value:(t=Object(o.a)(regeneratorRuntime.mark((function e(t){var n,r,o,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>1&&void 0!==c[1]?c[1]:[],r={group:t,username:this.username,members:n},e.next=4,this.api.post("/groups/create",r);case 4:if(!((o=e.sent).status>=400)){e.next=7;break}return e.abrupt("return",o.statusText);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"listGroups",value:function(){return this.groups.map((function(e){return e.info}))}},{key:"addMessage",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===(t=this.active)||void 0===t?void 0:t.info.id,r=arguments.length>2?arguments[2]:void 0,o=this.getGroupById(n);return o.addMessage(e,this.active===o,r)}},{key:"getGroupById",value:function(e){return this.groups.find((function(t){var n=t.info.id;return e===n}))}},{key:"active",get:function(){return this._activeGroup},set:function(e){this._activeGroup=this.getGroupById(e),this._activeGroup.markAsRead()}}]),e}(),v=(n(59),n(120),n(42),n(79),n(81),n(274),function(){function e(t,n){var r=this;Object(c.a)(this,e),this.api=t,this.username=null,this._channels={},this._channel=null,this.contacts={},n.addListener("connect",(function(e){r.username=e.username}))}var t;return Object(f.a)(e,[{key:"load",value:(t=Object(o.a)(regeneratorRuntime.mark((function e(){var t,n,r,o,c=this,f=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=f.length>0&&void 0!==f[0]?f[0]:0,n=f.length>1&&void 0!==f[1]?f[1]:10,r={offset:t,limit:n,username:this.username},e.next=5,this.api.post("/user/contacts/available",r);case 5:if(!((o=e.sent).status>=400)){e.next=8;break}throw new Error(o.statusText);case 8:return o.data.contacts.forEach((function(e){var t=e.name,n=e.username;return c.addChannel(n,t)})),e.next=11,this.api.post("/user/contacts/mutual",r);case 11:if(!((o=e.sent).status>=400)){e.next=14;break}throw new Error(o.statusText);case 14:this.contacts=o.data.contacts.reduce((function(e,t){var n=t.name;return e[t.username]=n,e}),{});case 15:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"addChannel",value:function(e,t){this.hasChannel(e)||(this._channels[e]={messages:[],unread:0,name:t})}},{key:"hasChannel",value:function(e){return e in this._channels}},{key:"addMessage",value:function(e){var time=new Date(e.timestamp),t=time.getMinutes().toString();t=1===t.length?"0"+t:t;var n=time.getHours(),r=n>=12?"pm":"am";n=(n%=12).toString().length>1?n:"0".concat(n),this.addChannel(e.channel,e.name);var o=e.sender===this.username,c=e.type||"text",f={title:"".concat(n,":").concat(t," ").concat(r),subtitle:"image"===e.type?URL.createObjectURL(e.message):e.message,self:o,name:e.name||this._channels[e.channel].name,type:c};return this._channels[e.channel].messages.push(f),this.channel!==e.channel&&this._channels[e.channel].unread++,o||e.blocked||(this.contacts[e.channel]=e.name),f}},{key:"listChannels",value:function(){for(var e=[],t=0,n=Object.entries(this._channels);t<n.length;t++){var o=Object(r.a)(n[t],2),c=o[0],f=o[1],h=f.unread,l=f.name;e.push({subtitle:c,unread:h,title:l,id:c})}return e}},{key:"listContacts",value:function(){return Object.entries(this.contacts)}},{key:"messages",get:function(){var e;return(null===(e=this._channels[this.channel])||void 0===e?void 0:e.messages)||[]}},{key:"channel",get:function(){return this._channel},set:function(e){this._channels[e]&&(this._channels[e].unread=0),this._channel=e}}]),e}()),y=(n(70),n(83),n(27),n(10)),k=n(22),w=n(21),x=n(11),O=n(66);function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(x.a)(e);if(t){var o=Object(x.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(w.a)(this,n)}}var R=function(e){Object(k.a)(n,e);var t=j(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).username=null,e.socket=null,e.timer=null,e}return Object(f.a)(n,[{key:"startHeartbeat",value:function(){var e=this;this.timer&&clearTimeout(this.timer),this.timer=setInterval((function(){e.socket.readyState!==e.socket.CLOSED&&e.socket.readyState!==e.socket.CLOSING?e.sendMessage("PING"):clearInterval(e.timer)}),25e3)}},{key:"sendMessage",value:function(e){"object"===Object(y.a)(e)&&(e=JSON.stringify(e)),this.startHeartbeat(),this.socket.send(e)}},{key:"onMessage",value:function(e){var data=e.data;if("ok"!==data&&"PING"!==data)try{var body="object"===Object(y.a)(data)?data:JSON.parse(data);this.listenerCount(body.event)&&this.emit(body.event,body)}catch(e){console.log(e)}this.startHeartbeat()}},{key:"addUser",value:function(e){var t={event:"user:connecting",username:e};this.sendMessage(t)}},{key:"connect",value:function(e){var t=this;if(!this.socket){this.username=e;var n=("https:"===window.location.protocol?"wss://":"ws://")+[window.location.hostname,window.location.port].filter((function(e){return!!e})).join(":")+"/ws";this.socket=new WebSocket(n),this.socket.onopen=function(){t.sendMessage({event:"authenticate",username:t.username})},this.socket.onmessage=this.onMessage.bind(this),this.socket.onclose=function(){},this.removeAllListeners("authenticate"),this.addListener("authenticate",(function(e){t.startHeartbeat(),t.emit("connect",e)}))}}}]),n}(O.EventEmitter),_=function(){function e(t){Object(c.a)(this,e),this.connection=t}return Object(f.a)(e,[{key:"onNewMessageHandler",value:function(e){this.connection.addListener("user:message_reply",e),this.connection.addListener("group:message_reply",e)}},{key:"user",value:function(e,t){var body={event:"user:message_send",receipient:e,message:t};this.connection.sendMessage(body)}},{key:"group",value:function(e,t){this.connection.sendMessage({event:"group:message_send",group:e,message:t})}}]),e}(),S=function(){function e(t,n,r){var o=t.store;Object(c.a)(this,e),this.api=n,this.store=o,this.connection=r}var t,n,r,h,l,d;return Object(f.a)(e,[{key:"setUserInfo",value:function(data){var e=data.token,t=data.expiry,n=data.username,r=data.name;this.store.commit("auth/setAuth",{token:e,expiry:t}),n&&r&&this.store.commit("app/setUserInfo",{username:n,name:r,isLoggedIn:!0})}},{key:"block",value:(d=Object(o.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.post("/user/block",t);case 2:if(!(e.sent.status>=400)){e.next=5;break}return e.abrupt("return",!1);case 5:return e.abrupt("return",!0);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"search",value:(l=Object(o.a)(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.connection.username,e.next=3,this.api.post("/user/search",{query:t,username:n});case 3:if(!((r=e.sent).status>=400)){e.next=6;break}return e.abrupt("return",{error:r.statusText});case 6:return e.abrupt("return",{results:r.data.results});case 7:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"login",value:(h=Object(o.a)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.post("/auth/login",t);case 2:if(200===(n=e.sent).status){e.next=5;break}return e.abrupt("return",{error:n.statusText});case 5:return this.setUserInfo(n.data),e.abrupt("return",{});case 7:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"logout",value:(r=Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.get("/auth/logout");case 2:this.store.commit("auth/setAuth",{token:null,expiry:null}),this.store.commit("app/removeUserInfo");case 4:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"refresh",value:(n=Object(o.a)(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.store.state.auth.token||"invalidToken",e.next=4,this.api.post("/refresh_token",{token:t});case 4:if(!((n=e.sent).status>=400)){e.next=7;break}throw n.statusText;case 7:return this.setUserInfo(n.data),e.abrupt("return",n.data);case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",{error:e.t0});case 14:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(){return n.apply(this,arguments)})},{key:"register",value:(t=Object(o.a)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.post("/auth/create",t);case 2:if(!((n=e.sent).status>=400)){e.next=5;break}return e.abrupt("return",n.statusText);case 5:return e.abrupt("return",this.login({username:t.username,password:t.password}));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}(),E=(n(47),n(68)),I=n(262),C=n.n(I);function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(x.a)(e);if(t){var o=Object(x.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(w.a)(this,n)}}var L=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Object(c.a)(this,e),this.connection=new C.a({initiator:t,trickle:!1})}return Object(f.a)(e,[{key:"waitForEvent",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"signal";return new Promise((function(n){e.connection.on(t,(function r(data){e.connection.off(t,r),n(data)}))}))}},{key:"getSignalData",value:function(){return this.waitForEvent()}}]),e}(),U=function(){function e(){Object(c.a)(this,e)}return Object(f.a)(e,null,[{key:"getPromise",value:function(e,t){var n,r=new Promise((function(t,r){n=setTimeout((function(){return r(Error("Timeout while wating for promise"))}),e)}));return Promise.race([t,r]).then((function(e){return e})).finally((function(){clearTimeout(n)}))}}]),e}(),F=function(e){Object(k.a)(l,e);var t,n,h=M(l);function l(e){var t;return Object(c.a)(this,l),(t=h.call(this)).connection=e,t.connection.addListener("user:rtc_offer",t.onOffer.bind(Object(E.a)(t))),t.connection.addListener("user:rtc_answer",t.onAnswer.bind(Object(E.a)(t))),t.answerStore={},t}return Object(f.a)(l,[{key:"onOffer",value:(n=Object(o.a)(regeneratorRuntime.mark((function e(t){var n,r,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=3;break}return this.answerStore[t.sender]?this.answerStore[t.sender][1](new Error(t.error)):this.emit("onConnect",{error:new Error(t.error),receipient:t.sender}),e.abrupt("return");case 3:return(n=new L(!1)).connection.signal(t.offer),e.next=7,n.getSignalData();case 7:r=e.sent,this.connection.sendMessage({event:"user:rtc_answer",receipient:t.sender,answer:r}),n.connection.on("error",(function(e){o.emit("onRequest",{error:e,sender:t.sender})})),n.connection.on("connect",(function(){o.emit("onRequest",{instance:n,sender:t.sender})}));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"onAnswer",value:function(e){var t=this.answerStore[e.sender],n=Object(r.a)(t,2),o=n[0],c=n[1];if(e.error)return c(new Error(e.error));o(e),delete this.answerStore[e.sender]}},{key:"initConnection",value:(t=Object(o.a)(regeneratorRuntime.mark((function e(t){var n,r,o,c,f,h,l=this,d=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=d.length>1&&void 0!==d[1]?d[1]:5e3,e.prev=1,r=new L(!0),e.next=5,r.getSignalData();case 5:return o=e.sent,c=new Promise((function(e,n){l.connection.sendMessage({event:"user:rtc_offer",receipient:t,offer:o}),l.answerStore[t]=[e,n]})),e.next=9,U.getPromise(n,c);case 9:return f=e.sent,h=f.answer,r.connection.signal(h),e.next=14,r.waitForEvent("connect");case 14:this.emit("onConnect",{instance:r,receipient:t}),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),this.emit("onConnect",{receipient:t,error:e.t0});case 20:case"end":return e.stop()}}),e,this,[[1,17]])}))),function(e){return t.apply(this,arguments)})}]),l}(O.EventEmitter);function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(x.a)(e);if(t){var o=Object(x.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(w.a)(this,n)}}var P=function(e){Object(k.a)(n,e);var t=T(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).onConnectEvent="onFileSend",r.onRequestEvent="onFileReceive",r}return Object(f.a)(n,[{key:"init",value:function(e){this.transport.initConnection(e)}},{key:"send",value:function(e,t,n){var r=this,o=t.connection,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16384,f=0,h=new FileReader;return o.on("error",(function(e){r.emit(r.onConnectEvent,{error:e,receipient:n})})),new Promise((function(t){var n=[];h.addEventListener("load",(function(c){o.send(c.target.result),f+=c.target.result.byteLength,n.push(c.target.result),f<e.size?r(f):(o.destroy(),t(n))}));var r=function(t){var n=e.slice(f,t+c);h.readAsArrayBuffer(n)};r(0)}))}}]),n}(function(e){Object(k.a)(n,e);var t=T(n);function n(e,r){var o;return Object(c.a)(this,n),(o=t.call(this)).connection=e,o.transport=new F(e,r),o.onConnectEvent="onConnect",o.onRequestEvent="onRequest",o.transport.on("onConnect",o.onConnect.bind(Object(E.a)(o))),o.transport.on("onRequest",o.onRequest.bind(Object(E.a)(o))),o}return Object(f.a)(n,[{key:"onConnect",value:function(data){this.emit(this.onConnectEvent,data)}},{key:"onRequest",value:function(data){this.emit(this.onRequestEvent,data)}}]),n}(O.EventEmitter)),A=n(77),D=n.n(A),G=function(){function e(t){var n=t.store,r=t.$config;Object(c.a)(this,e),this.api=D.a.create({baseURL:r.apiURL,withCredentials:!0}),this.store=n}return Object(f.a)(e,[{key:"post",value:function(e,data){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{headers:{"Content-Type":"application/json"}};return data.token=this.store.state.auth.token,this.api.post(e,JSON.stringify(data),t)}},{key:"get",value:function(e){return this.api.get(e)}}]),e}();t.a=function(e,t){var n=new R,r=new _(n),o=new G(e);t("sdk",{Connection:n,Message:r,User:new S(e,o,n),File:new P(n),Managers:{Users:new v(o,n),Groups:new m(o,n)}})}},219:function(e,t,n){var content=n(297);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(14).default)("6570a8f6",content,!0,{sourceMap:!1})},221:function(e,t,n){var content=n(303);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(14).default)("d935a26a",content,!0,{sourceMap:!1})},222:function(e,t,n){var content=n(305);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(14).default)("2f61aa80",content,!0,{sourceMap:!1})},264:function(e,t,n){"use strict";var r={data:function(){return{clipped:!1,drawer:!1,fixed:!1,items:[{icon:"mdi-apps",title:"Welcome",to:"/"},{icon:"mdi-chart-bubble",title:"Inspire",to:"/inspire"}],miniVariant:!1,right:!0,title:"Vuetify.js"}}},o=(n(302),n(304),n(78)),c=n(118),f=n.n(c),h=n(413),component=Object(o.a)(r,(function(){var e=this.$createElement,t=this._self._c||e;return t("v-app",{attrs:{dark:""}},[t("nuxt")],1)}),[],!1,null,"5c434d53",null);t.a=component.exports;f()(component,{VApp:h.a})},276:function(e,t,n){n(277),e.exports=n(278)},296:function(e,t,n){"use strict";n(219)},297:function(e,t,n){(t=n(13)(!1)).push([e.i,"h1[data-v-495dc2cf]{font-size:20px}",""]),e.exports=t},302:function(e,t,n){"use strict";n(221)},303:function(e,t,n){(t=n(13)(!1)).push([e.i,"#main-container[data-v-5c434d53]{padding:0}",""]),e.exports=t},304:function(e,t,n){"use strict";n(222)},305:function(e,t,n){(t=n(13)(!1)).push([e.i,"html{overflow-y:hidden!important}",""]),e.exports=t},306:function(e,t,n){"use strict";n.r(t),n.d(t,"state",(function(){return h})),n.d(t,"mutations",(function(){return l}));var r=n(2);function o(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function c(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?o(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):o(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var f={name:null,username:null,isLoggedIn:!1},h=function(){return{darkMode:!0,userInfo:c({},f)}},l={toggleDarkMode:function(e,t){e.darkMode=t},setUserInfo:function(e,t){Object.assign(e.userInfo,t)},removeUserInfo:function(e){e.userInfo=c({},f),localStorage.setItem("logout",Date.now())}}},307:function(e,t,n){"use strict";n.r(t),n.d(t,"state",(function(){return r})),n.d(t,"mutations",(function(){return o}));var r=function(){return{token:null,expiry:null}},o={setAuth:function(e,t){var n=t.token,r=t.expiry;e.token=n,e.expiry=r}}},393:function(e,t){},395:function(e,t){},403:function(e,t,n){"use strict";n.r(t);n(46);var r=n(4),o=(n(27),n(8)),c=n(9),f=function(){function e(t,n){Object(o.a)(this,e),this.timer=null,this.refreshFn=null,this.logoutFn=null,this.store=n,this.expiry=t,window.onstorage=this.monitorStorage.bind(this)}var t,n,f;return Object(c.a)(e,[{key:"monitorStorage",value:(f=Object(r.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("logout"!==t.key){e.next=4;break}return this.destroy(),e.next=4,this.logoutFn();case 4:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"setRefreshHandler",value:function(e){this.refreshFn=e}},{key:"setLogoutHandler",value:function(e){this.logoutFn=e}},{key:"onExpire",value:(n=Object(r.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.refreshFn();case 2:if(!(t=e.sent).error){e.next=5;break}return e.abrupt("return",t.error);case 5:this.expiry=t.expiry;case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"init",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="number"==typeof this.expiry?this.expiry-18e4:0,this.timer&&this.destroy(),!(t<=0)){e.next=9;break}return e.next=5,this.onExpire();case 5:if(!(n=e.sent)){e.next=8;break}return e.abrupt("return",n);case 8:t=this.expiry-18e4;case 9:this.timer=setTimeout(Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.init();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),t);case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"destroy",value:function(){clearTimeout(this.timer),this.timer=null}}]),e}();t.default=function(e){return h.apply(this,arguments)};function h(){return(h=Object(r.a)(regeneratorRuntime.mark((function e(t){var n,o,c,h,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.$sdk,o=t.store,c=t.error,(h=new f(o.state.auth.expiry,o)).setRefreshHandler((function(){return n.User.refresh()})),h.setLogoutHandler(Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.User.logout();case 2:window.location.href="/login";case 3:case"end":return e.stop()}}),e)})))),o.state.app.userInfo.isLoggedIn){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,h.init();case 8:if(!(l=e.sent)){e.next=11;break}return e.abrupt("return",c({statusCode:500,message:l}));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},67:function(e,t,n){"use strict";var r={layout:"empty",props:{error:{type:Object,default:null}},data:function(){return{pageNotFound:"404 Not Found",otherError:"An error occurred"}},head:function(){return{title:404===this.error.statusCode?this.pageNotFound:this.otherError}}},o=(n(296),n(78)),c=n(118),f=n.n(c),h=n(413),component=Object(o.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",{attrs:{dark:""}},[404===e.error.statusCode?n("h1",[e._v("\n    "+e._s(e.pageNotFound)+"\n  ")]):n("h1",[e._v("\n    "+e._s(e.otherError)+"\n  ")]),e._v(" "),n("NuxtLink",{attrs:{to:"/"}},[e._v(" Home page ")])],1)}),[],!1,null,"495dc2cf",null);t.a=component.exports;f()(component,{VApp:h.a})}},[[276,5,2,6]]]);